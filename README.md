# Regulatory-genetic-polymorphism
Documentation of software developed for the manuscript
Pervasive heterozygote advantage and polymorphism in regulatory genetic interactions 
  Adam H. Porter, Norman A. Johnson, and Alexander Y. Tulchinsky
  University of Massachusetts - Amherst

All are copywrite 2019-2022, by Adam Porter

Read the manuscript to learn about the parameters of the model and what the analyses do.  The model is described in Appendix 1, 
and the optimization albgorithm is described in Appendix 5.

mainThreaded20210228.cpp:
This is the code for the polymorphism analysis -- finding the genotypes that yield optimal mean fitness nd deetermining which of
those sites are polymorphic.  It can be compiled and run in XCode, or in g++ for running in a command line interface.  
It includes multithreading, so compile it with that option.  The command-line interface
allows the specification of the range of Popt values; by default it is the whole 0-1 range.  Inspect the first several lines of
main.cpp to see the order that command-line parameters are listed when running the analysis.

runFitnessOverdomPoptB6Script.sh
If using more than bitstrings greater than length 4 while allowing all three sites to vary, I recommending running each Popt value 
separately on a computational cluster, using a batch script.   
This batch file is for the 6-bit case, with each Popt value on a different core.  
Individual Popt runs can take from a few minutes to several days or even weeks.

concatFitnessOverdomFiles.sh:
When the output files are finished, concatenate them for graphical presentation. Before running this, remove any Popt-specific files that
have size=0, because they timed out. I export this file to my personal computr for further analysis.
After running the individual Popt cases below, concatenate those results manually using a copy/paste on my personal computer.

******* Individual Popt runs *************
runFitnessOverdom1PoptB6ScriptV2.sh:
Sometimes when running runFitnessOverdomPoptB6Script.sh, one or more of the individual Popt runs will time out.  Use this script
to rerun those cases individually.  It runs each value for the first TF allele's dosage site individuallyb (there are 
64 TF values/site/allele copy in a 6-bit analysis).  The output files should be concatenated into one for that individual Popt value.

runFitnessOverdom1PoptB6ScriptV3.sh:
Much more rarely, a TF run generated by runFitnessOverdom1PoptB6ScriptV2.sh times out.  I rerun those individually with a longer
time cap using the script below.



concatFitnessOverdomTFFiles.sh:
Concatenate the files generated by the above script.  Then, I export the file to my personal computer before continuing.
Notice that different TF values can yield different maximum fitnesses.  In this concatenated file, sort by wBarMax and remove any lines that are 
below the global wBarMax.  Then, copy/pasting the output into the file generated by concatFitnessOverdomFiles.sh.







I used Excel
to produce the the relevant figures in the manuscript (Figs. 3 and Appendix Figs. S3, S4 & S5).
